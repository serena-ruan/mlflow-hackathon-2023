"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
/** @jsxRuntime classic /
/** @jsx jsx */
const react_1 = require("react");
const classnames_1 = __importDefault(require("classnames"));
const react_2 = require("@emotion/react");
const react_feather_1 = require("react-feather");
const Dropdown_css_1 = __importDefault(require("./Dropdown.css"));
const useOnClickOutside_1 = require("../../helpers/hooks/useOnClickOutside");
const useKeyPress_1 = require("../../helpers/hooks/useKeyPress");
const BORDER_RADIUSES = {
    0: 'uil-bdr-0',
    2: 'uil-bdr-2',
    4: 'uil-bdr-4',
    6: 'uil-bdr-6',
    8: 'uil-bdr-8',
};
const renderIcon = (icon, iconProps) => {
    const CustomIconTag = icon;
    const { className: otherClassName, css: otherCss, ...otherProps } = iconProps;
    return (react_2.jsx(CustomIconTag, Object.assign({}, otherProps, { css: [Dropdown_css_1.default.icon, otherCss], "aria-hidden": true, className: classnames_1.default('uil-pos-relative uil-fxs-0 uil-mr-8', otherClassName) })));
};
const renderLabel = (counter, label, refinedLabel) => {
    if (counter === 0)
        return label;
    if (counter === 1)
        return (refinedLabel && refinedLabel.single) || label;
    if (counter > 1)
        return (refinedLabel && refinedLabel.multiple) || label;
    return false;
};
/**
 * This component allows you to create simple and elegant dropdowns based on either
 * a `data` attribute that will receive an object, or an InstantSearch facet attribute.
 */
const Dropdown = ({ borderColor = 'light-grey', borderRadius = 4, children, count = 0, disabled, icon, iconProps = {}, label, refinedLabel = {}, ...other }) => {
    const [showList, setShowList] = react_1.useState(false);
    const [counter, setCounter] = react_1.useState(count);
    const dropdownRef = react_1.useRef(null);
    const listRef = react_1.useRef(null);
    const { className: otherClassName, ...otherProps } = other;
    react_1.useEffect(() => {
        if (listRef.current) {
            listRef.current.addEventListener('click', () => {
                const checkedBoxes = listRef.current &&
                    listRef.current.querySelectorAll('input[type=checkbox]:checked');
                checkedBoxes && !count && setCounter(checkedBoxes.length);
            });
        }
    }, []);
    react_1.useEffect(() => {
        setCounter(count);
    }, [count]);
    dropdownRef &&
        useOnClickOutside_1.useOnClickOutside(dropdownRef, () => showList ? setShowList(false) : null);
    useKeyPress_1.useKeyPress('Escape', () => {
        setShowList(false);
    });
    return (react_2.jsx("div", Object.assign({}, otherProps, { className: classnames_1.default('uil-pos-relative uil-miw-200', borderColor !== 'transparent' && `uil-bdw-1 uil-bds-solid`, borderColor === 'light-grey'
            ? 'uil-bdc-grey-200'
            : 'uil-bdc-transparent', BORDER_RADIUSES[borderRadius], disabled && 'uil-op-75p', otherClassName), ref: dropdownRef }),
        react_2.jsx("button", { disabled: disabled, onClick: () => setShowList(!showList), className: classnames_1.default('uil-app-none uil-ff-poppins uil-bdw-0 uil-d-flex uil-ai-center uil-jc-between uil-fsz-14 uil-ph-16 uil-bgc-transparent uil-h-40 uil-w-100p lg:uil-fsz-16', disabled
                ? 'uil-cursor-not-allowed uil-color-grey-400'
                : 'uil-cursor-pointer uil-color-grey-500', BORDER_RADIUSES[borderRadius]) },
            react_2.jsx("span", { className: "uil-d-flex uil-ai-center" },
                icon && renderIcon(icon, iconProps),
                ' ',
                counter > 0 && (react_2.jsx("span", { className: "uil-fsz-12 uil-fw-bold uil-bgc-grey-100 uil-bdr-4 uil-mr-8", css: Dropdown_css_1.default.labelCount }, counter)),
                react_2.jsx("span", null, renderLabel(counter, label, refinedLabel))),
            showList ? (react_2.jsx(react_feather_1.ChevronUp, { className: "stroke-current" })) : (react_2.jsx(react_feather_1.ChevronDown, { className: "stroke-current" }))),
        react_2.jsx("ul", { className: classnames_1.default('uil-lis-none uil-p-0 uil-mv-8 uil-pos-absolute uil-z-4 uil-top-32 uil-left-0 uil-d-flex uil-fxd-column uil-bxs-large uil-ov-hidden uil-w-100p', showList ? 'uil-op-1 uil-v-visible' : 'uil-op-0 uil-v-hidden', BORDER_RADIUSES[borderRadius]), css: [
                Dropdown_css_1.default.listRoot,
                showList ? Dropdown_css_1.default.listAppear : Dropdown_css_1.default.listHidden,
            ], ref: listRef }, children)));
};
exports.default = Dropdown;
//# sourceMappingURL=Dropdown.js.map