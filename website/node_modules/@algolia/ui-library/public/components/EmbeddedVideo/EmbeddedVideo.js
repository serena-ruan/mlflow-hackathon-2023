"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
/** @jsxRuntime classic /
/** @jsx jsx */
const classnames_1 = __importDefault(require("classnames"));
const react_1 = require("@emotion/react");
const index_1 = require("../../index");
const EmbeddedVideo_css_1 = __importDefault(require("./EmbeddedVideo.css"));
const helpers_1 = require("../../helpers");
const VideoWrapper = ({ autoPlay, iframeProps = {}, link, url, ...other }) => {
    const { className: iframeClassName, ...otherIframeProps } = iframeProps;
    const { className: otherClassName, ...otherProps } = other;
    let videoUrl = url || link;
    const isEmbed = helpers_1.isVideoEmbed(videoUrl);
    let style = null;
    if (isEmbed) {
        style = EmbeddedVideo_css_1.default[isEmbed];
        if (autoPlay) {
            if (videoUrl.indexOf('?') > -1) {
                const splitUrl = videoUrl.split('?');
                /** Split is necessary. Otherwise, it will return the whole URL, url-encoded, with .toString(). */
                const currentUrlParams = new URLSearchParams(splitUrl[1]);
                /** Even if autoplay is set, this will force its value to 1. */
                currentUrlParams.set('autoplay', '1');
                /** As we split at the '?' position, we need to add back '?' right before the parameters. */
                const currentUrlParamsStr = `?${currentUrlParams.toString()}`;
                videoUrl = splitUrl[0] + currentUrlParamsStr;
            }
            else {
                videoUrl += '?autoplay=1';
            }
        }
    }
    if (isEmbed) {
        return (react_1.jsx("div", Object.assign({}, otherProps, { className: classnames_1.default('uil-w-100p', otherClassName) }),
            react_1.jsx("div", { css: style, className: "uil-bgc-grey-900 uil-bxs-default uil-bdr-2 uil-pos-relative uil-h-0 uil-ov-hidden uil-pt-24 uil-w-100p" },
                react_1.jsx("iframe", Object.assign({}, otherIframeProps, { className: classnames_1.default('uil-bd-none uil-pos-absolute uil-left-0 uil-top-0 uil-w-100p uil-h-100p', iframeClassName), src: videoUrl })))));
    }
    else {
        throw new Error('Wrong video source, you can only use embeddable videos url from: Youtube, Vimeo or Vidyard');
    }
};
const EmbeddedVideo = ({ autoPlay, iframeProps = {}, link, url, ...other }) => {
    return (react_1.jsx(index_1.ErrorBoundary, null,
        react_1.jsx(VideoWrapper, Object.assign({}, other, { autoPlay: autoPlay, iframeProps: iframeProps, link: link, url: url }))));
};
exports.default = EmbeddedVideo;
//# sourceMappingURL=EmbeddedVideo.js.map